<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SMS Booking Test - Cube Notary</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            background: #f5f5f5; 
            line-height: 1.6;
        }
        .test-container { 
            max-width: 800px; 
            margin: 0 auto; 
            background: white; 
            padding: 20px; 
            border-radius: 8px; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section { 
            background: #f8f9fa; 
            padding: 15px; 
            margin: 15px 0; 
            border-radius: 5px; 
            border-left: 4px solid #007bff; 
        }
        .test-section h3 { 
            margin: 0 0 10px 0; 
            color: #333; 
        }
        .test-button { 
            background: #28a745; 
            color: white; 
            border: none; 
            padding: 10px 20px; 
            border-radius: 5px; 
            cursor: pointer; 
            margin: 5px;
            font-size: 14px;
        }
        .test-button:hover { 
            background: #218838; 
        }
        .test-button.danger { 
            background: #dc3545; 
        }
        .test-button.danger:hover { 
            background: #c82333; 
        }
        .result { 
            padding: 10px; 
            margin: 10px 0; 
            border-radius: 4px; 
            font-family: monospace;
            white-space: pre-wrap;
        }
        .success { 
            background: #d4edda; 
            color: #155724; 
            border: 1px solid #c3e6cb; 
        }
        .error { 
            background: #f8d7da; 
            color: #721c24; 
            border: 1px solid #f5c6cb; 
        }
        .info { 
            background: #d1ecf1; 
            color: #0c5460; 
            border: 1px solid #bee5eb; 
        }
        .sms-preview {
            background: #e9ecef;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            white-space: pre-wrap;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üß™ SMS Booking System Test - Cube Notary</h1>
        
        <div class="test-section">
            <h3>üì± Test SMS Booking Functionality</h3>
            <p>This will test the SMS booking system with sample data:</p>
            <button class="test-button" onclick="testSMSBooking()">Test SMS Booking</button>
            <button class="test-button danger" onclick="testSMSBookingInvalid()">Test Invalid Data</button>
            <div id="sms-result"></div>
        </div>

        <div class="test-section">
            <h3>üìã SMS Message Preview</h3>
            <p>This shows what the SMS message will look like:</p>
            <div class="sms-preview" id="sms-preview">Click "Test SMS Booking" to see the message format</div>
        </div>

        <div class="test-section">
            <h3>üîó Test SMS Link Generation</h3>
            <p>Test the SMS link generation without opening the SMS app:</p>
            <button class="test-button" onclick="testSMSLink()">Generate SMS Link</button>
            <div id="link-result"></div>
        </div>

        <div class="test-section">
            <h3>üìÖ Test Calendar Integration</h3>
            <p>Test if the calendar and modal work correctly:</p>
            <button class="test-button" onclick="testCalendar()">Test Calendar</button>
            <div id="calendar-result"></div>
        </div>

        <div class="test-section">
            <h3>üåê Test Live Deployment</h3>
            <p>Check if the live site is working:</p>
            <button class="test-button" onclick="testLiveSite()">Test Live Site</button>
            <div id="live-result"></div>
        </div>

        <div class="test-section">
            <h3>üìä Test Results Summary</h3>
            <div id="summary-result"></div>
        </div>
    </div>

    <script>
        let testResults = {
            smsBooking: false,
            smsLink: false,
            calendar: false,
            liveSite: false
        };

        function testSMSBooking() {
            const resultDiv = document.getElementById('sms-result');
            const previewDiv = document.getElementById('sms-preview');
            
            try {
                // Simulate form data
                const testData = {
                    day: '25',
                    month: 12,
                    year: 2024,
                    service: 'Power of Attorney notarization',
                    fullname: 'John Smith',
                    address: '123 Main St, Chicago, IL 60601',
                    time: '14:30'
                };

                // Format the appointment details for SMS (same as in the main site)
                const appointmentDate = `${testData.month}/${testData.day}/${testData.year}`;
                const smsMessage = `New Appointment Request:
üìÖ Date: ${appointmentDate}
‚è∞ Time: ${testData.time}
üë§ Name: ${testData.fullname}
üìç Address: ${testData.address}
üìã Service: ${testData.service}

Please confirm this appointment.`;

                // Show the SMS message preview
                previewDiv.textContent = smsMessage;

                // Test SMS link generation
                const smsLink = `sms:+13124683477?body=${encodeURIComponent(smsMessage)}`;
                
                resultDiv.innerHTML = `<div class="result success">‚úÖ SMS booking test passed!
SMS Link: ${smsLink}
Message length: ${smsMessage.length} characters</div>`;
                
                testResults.smsBooking = true;
                updateSummary();
                
            } catch (error) {
                resultDiv.innerHTML = `<div class="result error">‚ùå SMS booking test failed: ${error.message}</div>`;
                testResults.smsBooking = false;
                updateSummary();
            }
        }

        function testSMSBookingInvalid() {
            const resultDiv = document.getElementById('sms-result');
            
            try {
                // Test with invalid data
                const invalidData = {
                    day: '',
                    month: 12,
                    year: 2024,
                    service: '',
                    fullname: 'A', // Too short
                    address: '',
                    time: ''
                };

                // This should trigger validation errors
                if (!invalidData.service || !invalidData.fullname || !invalidData.address || !invalidData.time) {
                    resultDiv.innerHTML = `<div class="result success">‚úÖ Validation working correctly - caught invalid data</div>`;
                } else {
                    resultDiv.innerHTML = `<div class="result error">‚ùå Validation failed - should have caught invalid data</div>`;
                }
                
            } catch (error) {
                resultDiv.innerHTML = `<div class="result error">‚ùå Invalid data test failed: ${error.message}</div>`;
            }
        }

        function testSMSLink() {
            const resultDiv = document.getElementById('link-result');
            
            try {
                const testMessage = "Test message for Cube Notary";
                const smsLink = `sms:+13124683477?body=${encodeURIComponent(testMessage)}`;
                
                resultDiv.innerHTML = `<div class="result success">‚úÖ SMS link generated successfully!
Link: <a href="${smsLink}" target="_blank">${smsLink}</a></div>`;
                
                testResults.smsLink = true;
                updateSummary();
                
            } catch (error) {
                resultDiv.innerHTML = `<div class="result error">‚ùå SMS link test failed: ${error.message}</div>`;
                testResults.smsLink = false;
                updateSummary();
            }
        }

        function testCalendar() {
            const resultDiv = document.getElementById('calendar-result');
            
            try {
                // Test if calendar elements exist
                const calendar = document.getElementById('calendar');
                if (calendar) {
                    resultDiv.innerHTML = `<div class="result success">‚úÖ Calendar element found in main site</div>`;
                    testResults.calendar = true;
                } else {
                    resultDiv.innerHTML = `<div class="result info">‚ÑπÔ∏è Calendar element not found (expected in test page)</div>`;
                    testResults.calendar = true; // This is expected in test page
                }
                updateSummary();
                
            } catch (error) {
                resultDiv.innerHTML = `<div class="result error">‚ùå Calendar test failed: ${error.message}</div>`;
                testResults.calendar = false;
                updateSummary();
            }
        }

        function testLiveSite() {
            const resultDiv = document.getElementById('live-result');
            
            // Test if we can access the main site
            fetch('/public/index.html')
                .then(response => {
                    if (response.ok) {
                        resultDiv.innerHTML = `<div class="result success">‚úÖ Local site accessible
Status: ${response.status}
Content-Type: ${response.headers.get('content-type')}</div>`;
                        testResults.liveSite = true;
                    } else {
                        resultDiv.innerHTML = `<div class="result error">‚ùå Local site not accessible
Status: ${response.status}</div>`;
                        testResults.liveSite = false;
                    }
                    updateSummary();
                })
                .catch(error => {
                    resultDiv.innerHTML = `<div class="result error">‚ùå Live site test failed: ${error.message}</div>`;
                    testResults.liveSite = false;
                    updateSummary();
                });
        }

        function updateSummary() {
            const summaryDiv = document.getElementById('summary-result');
            const totalTests = Object.keys(testResults).length;
            const passedTests = Object.values(testResults).filter(result => result === true).length;
            
            let summaryHTML = `<div class="result ${passedTests === totalTests ? 'success' : 'info'}">
üìä Test Summary: ${passedTests}/${totalTests} tests passed

‚úÖ SMS Booking: ${testResults.smsBooking ? 'PASS' : 'FAIL'}
‚úÖ SMS Link: ${testResults.smsLink ? 'PASS' : 'FAIL'}
‚úÖ Calendar: ${testResults.calendar ? 'PASS' : 'FAIL'}
‚úÖ Live Site: ${testResults.liveSite ? 'PASS' : 'FAIL'}
</div>`;

            if (passedTests === totalTests) {
                summaryHTML += `<div class="result success">
üéâ All tests passed! Your SMS booking system is ready for production.
</div>`;
            } else {
                summaryHTML += `<div class="result error">
‚ö†Ô∏è Some tests failed. Please check the issues above.
</div>`;
            }
            
            summaryDiv.innerHTML = summaryHTML;
        }

        // Run initial tests
        window.onload = function() {
            testSMSLink();
            testCalendar();
            testLiveSite();
        };
    </script>
</body>
</html>
